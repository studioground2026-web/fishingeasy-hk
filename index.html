<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>é‡£é­šæ˜“ FishingEasy</title>

    <meta name="theme-color" content="#2563EB">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: { primary: '#2563EB', danger: '#E11D48', success: '#10B981' }
                }
            }
        }
    </script>

    <style>
        :root { --admob-banner-height: 50px; }
        body { padding-bottom: env(safe-area-inset-bottom); }
        #admob-banner-slot {
            padding-top: env(safe-area-inset-top);
            min-height: calc(env(safe-area-inset-top) + var(--admob-banner-height));
            height: calc(env(safe-area-inset-top) + var(--admob-banner-height));
        }
        #admob-banner { height: var(--admob-banner-height); }
        #bottom-nav {
            padding-bottom: env(safe-area-inset-bottom);
            min-height: calc(64px + env(safe-area-inset-bottom));
        }
        #view-map, #map { height: 100%; width: 100%; position: absolute; top: 0; left: 0; z-index: 1; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        input[type="checkbox"] { accent-color: #2563EB; width: 1.2rem; height: 1.2rem; }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 dark:bg-gray-900 dark:text-gray-100 h-screen flex flex-col overflow-hidden select-none">
    <div id="admob-banner-slot" class="w-full bg-gray-100 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 flex items-end justify-center z-[1200]">
        <div id="admob-banner" class="w-full max-w-[420px] h-[50px] flex items-center justify-center text-[11px] tracking-wide text-gray-400 dark:text-gray-500">
            AdMob Banner (320x50 / 320x100)
        </div>
    </div>

    <div id="disclaimer-modal" class="fixed inset-0 z-[2000] bg-black/90 flex items-center justify-center p-6 hidden">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl max-w-sm w-full shadow-2xl">
            <h2 class="text-2xl font-bold text-primary mb-4 text-center">å…è²¬è²æ˜ Disclaimer</h2>
            <div class="h-40 overflow-y-auto bg-gray-100 dark:bg-gray-700 p-3 rounded mb-4 text-sm leading-relaxed">
                <p>æœ¬æ‡‰ç”¨ç¨‹å¼ä¹‹åœ°åœ–åŠé­šé¡è³‡è¨Šåƒ…ä¾›åƒè€ƒã€‚å¯¦éš›å‚é‡£ç¯„åœåŠæ³•è¦ï¼Œè«‹å‹™å¿…ä»¥ç¾å ´æ°´å‹™ç½²å‘Šç¤ºç‰ŒåŠå®˜æ–¹æœ€æ–°å…¬å¸ƒç‚ºæº–ã€‚</p>
                <br>
                <p>ä½¿ç”¨è€…é ˆè‡ªè¡Œæ‰¿æ“”é€²å…¥æ°´å¡˜ç¯„åœä¹‹é¢¨éšªã€‚é–‹ç™¼è€…ä¸å°ä»»ä½•é•è¦æª¢æ§æˆ–æ„å¤–è² è²¬ã€‚</p>
                <br>
                <p>The map and fish information in this application are for reference only. For the actual fishing boundaries and regulations, please always refer to the on-site Water Supplies Department notice boards and the latest official announcements.</p>
                <br>
                <p>Users enter reservoir areas at their own risk. The developer assumes no responsibility for any regulatory violations, prosecutions, or accidents.</p>
            </div>
            <button onclick="acceptDisclaimer()" class="w-full bg-primary hover:bg-blue-600 text-white font-bold py-3 rounded-xl transition">
                æˆ‘æ˜ç™½ä¸¦åŒæ„ I Agree
            </button>
        </div>
    </div>

    <main class="flex-1 relative w-full h-full overflow-hidden">
        <div id="view-map" class="view-section w-full h-full">
            <div id="map"></div>

            <div id="map-status" class="absolute top-4 left-1/2 transform -translate-x-1/2 bg-white/90 dark:bg-gray-800/90 backdrop-blur px-4 py-2 rounded-full shadow-lg z-[1000] text-sm font-bold flex items-center gap-2 border border-gray-200 dark:border-gray-700">
                <span class="w-2 h-2 rounded-full bg-gray-400" id="status-dot"></span>
                <span id="status-text" data-i18n="locate_me">å®šä½ä¸­...</span>
            </div>

            <button onclick="locateUser()" class="absolute bottom-6 right-4 bg-white dark:bg-gray-800 p-3 rounded-full shadow-lg z-[1000] text-primary hover:bg-gray-100">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M12 8l4 4-4 4M8 12h8"></path></svg>
            </button>
        </div>

        <div id="view-dex" class="view-section h-full w-full absolute inset-0 bg-gray-50 dark:bg-gray-900 overflow-y-auto p-4 hidden z-[10]">
            <div id="fish-list" class="space-y-4 pb-20"></div>
        </div>

        <div id="view-log" class="view-section h-full w-full absolute inset-0 bg-gray-50 dark:bg-gray-900 overflow-y-auto p-4 hidden z-[10]">
            <h2 class="text-2xl font-bold mb-4">
                <span data-lang="zh">æ•é­šæ—¥èªŒ</span>
                <span data-lang="en" class="hidden">Fishing Log</span>
            </h2>
            <div id="log-empty" class="bg-white dark:bg-gray-800 rounded-xl p-8 text-center text-gray-500 dark:text-gray-300 border border-gray-100 dark:border-gray-700">
                <div class="text-4xl mb-3">ğŸ£</div>
                <p data-i18n="log_empty">æœªæœ‰æ¼ç²æ—¥èªŒï¼ŒæŒ‰ + æ–°å¢ç¬¬ä¸€ç­†ã€‚</p>
            </div>
            <div id="log-list" class="space-y-3 pb-24"></div>

            <button id="log-fab" onclick="startAddLog('upload')" class="fixed bottom-24 right-5 z-[300] w-14 h-14 rounded-full bg-primary hover:bg-blue-700 text-white text-3xl leading-none shadow-lg flex items-center justify-center" aria-label="Add log">+</button>

            <div id="log-modal" class="fixed inset-0 z-[400] bg-black/50 p-4 hidden">
                <div class="max-w-md w-[calc(100%-2rem)] absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-gray-800 rounded-2xl p-5 shadow-2xl border border-gray-100 dark:border-gray-700">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold" data-i18n="log_add">æ–°å¢æ¼ç²</h3>
                        <button onclick="closeLogModal()" class="text-gray-500 hover:text-gray-800 dark:hover:text-gray-200 text-xl leading-none" aria-label="Close">&times;</button>
                    </div>

                    <form onsubmit="saveLog(event)" class="space-y-4">
                        <label for="log-photo-input" class="block cursor-pointer border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-3 text-center bg-gray-50 dark:bg-gray-700/40">
                            <img id="log-photo-preview" alt="preview" class="hidden w-full h-44 object-cover rounded-lg mb-2">
                            <span class="text-sm text-gray-500 dark:text-gray-300">Photo</span>
                        </label>
                        <input id="log-photo-input" type="file" accept="image/*" capture="environment" onchange="handleLogPhotoChange(event)" class="hidden" required>

                        <input id="log-species" type="text" data-i18n-placeholder="log_species_placeholder" placeholder="é­šç¨®åç¨±" class="w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 px-3 py-2" required>

                        <input id="log-length" type="number" min="0" step="0.1" class="w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 px-3 py-2" placeholder="Length (cm)" required>

                        <input id="log-weight" type="number" min="0" step="0.1" class="w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 px-3 py-2" placeholder="Weight (kg)" required>

                        <input id="log-location" type="text" class="w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 px-3 py-2" placeholder="æ‹æ”åœ°é» / Location">

                        <input id="log-date" type="date" class="w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 px-3 py-2" required>

                        <div class="flex gap-2">
                            <button type="button" onclick="closeLogModal()" class="flex-1 rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2">Cancel</button>
                            <button type="submit" class="flex-1 rounded-lg bg-primary hover:bg-blue-700 text-white px-4 py-2 font-bold" data-i18n="log_save">å„²å­˜</button>
                        </div>
                    </form>
                </div>
            </div>

            <div id="log-detail-modal" class="fixed inset-0 z-[410] bg-black/60 p-4 hidden">
                <div class="max-w-md w-[calc(100%-2rem)] absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-gray-800 rounded-2xl overflow-hidden shadow-2xl border border-gray-100 dark:border-gray-700">
                    <img id="log-detail-image" alt="detail" class="w-full h-64 object-cover bg-gray-100 dark:bg-gray-700">
                    <div class="p-4 space-y-2">
                        <p id="log-detail-species" class="text-xl font-bold"></p>
                        <p id="log-detail-metrics" class="text-sm text-gray-700 dark:text-gray-200"></p>
                        <p id="log-detail-date" class="text-xs text-gray-500"></p>
                        <p id="log-detail-location" class="text-xs text-gray-500"></p>
                        <div id="log-detail-map-wrap" class="hidden pt-1">
                            <iframe id="log-detail-map" class="w-full h-36 rounded-lg border border-gray-200 dark:border-gray-700" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                        </div>
                        <div class="flex gap-2 pt-2">
                            <button id="log-share-btn" type="button" class="flex-1 rounded-lg bg-primary hover:bg-blue-700 text-white px-4 py-2 font-bold" data-i18n="share_btn">åˆ†äº«æˆ°åˆ©å“</button>
                            <button type="button" onclick="closeLogDetailModal()" class="flex-1 rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2">Close</button>
                        </div>
                    </div>
                </div>
            </div>

            <canvas id="share-canvas" width="1080" height="1350" class="hidden"></canvas>
        </div>

        <div id="view-rules" class="view-section h-full w-full absolute inset-0 bg-gray-50 dark:bg-gray-900 overflow-y-auto p-4 hidden z-[10]">
            <h2 class="text-2xl font-bold mb-6">
                <span data-lang="zh">ç‰Œç…§è¦å‰‡</span>
                <span data-lang="en" class="hidden">Licence & Rules</span>
            </h2>
            <div class="bg-gradient-to-r from-blue-600 to-blue-500 rounded-2xl p-6 text-white shadow-lg mb-4 relative overflow-hidden">
                <div class="relative z-10">
                    <p class="text-blue-100 text-sm mb-1" data-i18n="license_start">ç‰Œç…§ç”Ÿæ•ˆæ—¥æœŸ</p>
                    <input type="date" id="license-date" class="bg-white/20 text-white border-none rounded px-2 py-1 mb-4 w-full backdrop-blur-sm focus:outline-none" onchange="updateLicense()">
                    <div class="flex items-baseline gap-2">
                        <span id="days-left" class="text-4xl font-mono font-bold">---</span>
                        <span class="text-sm" data-i18n="days_left">å¤©å‰©é¤˜</span>
                    </div>
                </div>
            </div>
            <div class="bg-white dark:bg-gray-800 rounded-xl p-5 shadow-sm border border-gray-100 dark:border-gray-700 mb-4">
                <a data-lang="zh" href="https://www.wsd.gov.hk/tc/customer-services/other-customer-services/fishing-in-reservoirs/application-for-fishing-licence/index.html" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full bg-primary hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition">ç”³è«‹é‡£é­šç‰Œç…§</a>
                <a data-lang="en" href="https://www.wsd.gov.hk/en/customer-services/other-customer-services/fishing-in-reservoirs/application-for-fishing-licence/index.html" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full bg-primary hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition hidden">Apply for Fishing Licence</a>
            </div>
            <div class="bg-white dark:bg-gray-800 rounded-xl p-5 shadow-sm border border-gray-100 dark:border-gray-700 mb-4">
                <h3 class="font-bold mb-4 text-gray-500 text-sm uppercase tracking-wide" data-i18n="checklist_title">å‡ºç™¼å‰å®‰å…¨æª¢æŸ¥</h3>
                <div class="space-y-4" id="rules-checklist-container"></div>
            </div>
            <section data-lang="zh" class="bg-white dark:bg-gray-800 rounded-xl p-5 shadow-sm border border-gray-100 dark:border-gray-700 mb-4">
                <h3 class="text-lg font-bold mb-3">æŒç‰Œé‡£é­šäººå£«é ˆæ³¨æ„åŠéµå®ˆé‡£é­šç‰Œç…§çš„è¦å‰‡</h3>
                <ul class="list-disc pl-5 space-y-3 text-sm leading-relaxed text-gray-700 dark:text-gray-200">
                    <li>æŒç‰Œäººå¯é€²å…¥åŠé€—ç•™åœ¨æ°´å¡˜å€ï¼Œä½†é‡æœ‰ä»»ä½•å±éšªï¼Œæ¦‚ç”±æŒç‰Œäººè² è²¬ã€‚æŒç‰Œäººå¿…é ˆæ¥å—æ°´å¡˜å€åœŸåœ°æˆ–å…¶ä¸Šä¸€åˆ‡äº‹ç‰©ç•¶æ™‚çš„æƒ…æ³ï¼Œè€Œä¸”ç„¡è«–åœ¨ä½•ç¨®æƒ…å½¢ä¸‹ï¼Œäº¦ä¸å¾—å› åœŸåœ°æˆ–å…¶ä¸Šäº‹ç‰©å¯èƒ½å¼•è‡´çš„è²¡ç‰©æå¤±æˆ–äººèº«å‚·äº¡è€Œå‘æ°´å‹™ç›£ç£æå‡ºä»»ä½•è³ å„Ÿè¦æ±‚ã€‚</li>
                    <li>é‡£é­šç‰Œç…§åªé™ä½¿ç”¨ä¸€æé‡£ç«¿åŠé‡£çµ²ï¼Œä¸”ä¸å¾—è½‰è®“ã€‚</li>
                    <li>é‡æœ‰è­¦å‹™äººå“¡æˆ–ç²æˆæ¬Šäººå“¡æŸ¥é–±æ™‚ï¼Œå¿…é ˆå‡ºç¤ºé‡£é­šç‰Œç…§ã€‚</li>
                    <li>å¹´é½¡åœ¨åä¸‰æ­²ä»¥ä¸‹äººå£«ä¸ç²ç™¼é‡£é­šç‰Œç…§ã€‚</li>
                    <li>åš´ç¦ä½¿ç”¨é­šç¶²æˆ–å…¶ä»–ç”¨å…·ï¼ˆé‡£ç«¿åŠé‡£çµ²é™¤å¤–ï¼‰æˆ–çˆ†ç‚¸å“æˆ–æœ‰æ¯’ç‰©è³ªæ•æ‰æˆ–æ®˜å®³é­šé¡ã€‚</li>
                    <li>ç¦ç”¨å°èˆ¹ï¼Œå°è‰‡ï¼Œæœ¨ç­ç­‰æ•é­šã€‚</li>
                    <li>é™¤äº†ç²è±å…é­šé¡å¤–ï¼Œé‡£ç²ä»¥ä¸‹é•·åº¦çš„é­šé¡å‡é ˆç”Ÿæ”¾å›æ°´å¡˜å…§ï¼š360 æ¯«ç±³ä»¥ä¸‹çš„é±¸é­šã€300 æ¯«ç±³ä»¥ä¸‹çš„ç”Ÿé­šåŠå…¶ä»– 180 æ¯«ç±³ä»¥ä¸‹çš„å„ç¨®é­šé¡ï¼Œè€Œé•·åº¦æ˜¯ç”±é­šé ­æœ€å‰ç«¯èµ·è¨ˆè‡³é­šå°¾æœ€æœ«ç«¯æ­¢ã€‚</li>
                    <li>é™¤äº†ç²è±å…é­šé¡å¤–ï¼Œæ¯åé‡£é­šäººå£«ä¸€å¤©ä¸­çš„é­šç²ï¼Œä¸å¾—å¤šæ–¼é•·åº¦ 360 æ¯«ç±³æˆ–ä»¥ä¸Šçš„é±¸é­šå…©å°¾ã€300 æ¯«ç±³æˆ–ä»¥ä¸Šçš„ç”Ÿé­šå…©å°¾ï¼Œä»¥åŠå…¶ä»– 180 æ¯«ç±³ä»¥ä¸Šæ¯ç¨®é­šé¡å…©å°¾ã€‚</li>
                    <li>ç•¶å±€æ—¥å¾Œå¯æ’¤éŠ·é‡£é­šç‰Œç…§ï¼Œä¸¦æŒ‰ä¸åŒæ¢æ¬¾å¦ç™¼ç‰Œç…§ã€‚</li>
                    <li>è«‹å°å¿ƒä¿å­˜é‡£é­šç‰Œç…§ï¼Œå¦‚æœ‰éºå¤±æˆ–æå£ï¼Œæ¦‚ä¸è£œç™¼ã€‚</li>
                </ul>
            </section>

            <section data-lang="zh" class="bg-white dark:bg-gray-800 rounded-xl p-5 shadow-sm border border-gray-100 dark:border-gray-700 mb-4">
                <h3 class="text-lg font-bold mb-3">æ­¤å¤–ï¼Œé‡£é­šäººå£«äº¦é ˆç•™æ„ï¼š</h3>
                <ul class="list-disc pl-5 space-y-3 text-sm leading-relaxed text-gray-700 dark:text-gray-200">
                    <li>é‡£é­šäººå£«åœ¨æ°´å¡˜æˆ–çŒæº‰æ°´å¡˜é‡£é­šæ™‚ï¼Œä¸å¯ä½¿ç”¨é‰›å¢œï¼Œä»¥å…é­šé¡ã€é›€é³¥æˆ–å¸‚æ°‘ä¸­é‰›æ¯’ã€‚</li>
                    <li>æœªç¶“æ°´å‹™ç›£ç£çš„å…è¨±ï¼Œä¸å¯æŠŠä»»ä½•å‹•ç‰©ï¼ŒåŒ…æ‹¬çˆ¬èŸ²æˆ–é­šé¡åœ¨æ°´å¡˜æˆ–çŒæº‰æ°´å¡˜æ”¾ç”Ÿã€‚</li>
                    <li>ä¸è¦åœ¨æ°´å¡˜ç¯„åœå…§æ‹‹æ£„åƒåœ¾æˆ–æ±¡æŸ“æ°´å¡˜ã€‚</li>
                </ul>
            </section>

            <section data-lang="en" class="bg-white dark:bg-gray-800 rounded-xl p-5 shadow-sm border border-gray-100 dark:border-gray-700 mb-4">
                <h3 class="text-lg font-bold mb-3">Licensed anglers are required to observe and comply with the prescribed conditions of fishing licence:</h3>
                <ul class="list-disc pl-5 space-y-3 text-sm leading-relaxed text-gray-700 dark:text-gray-200">
                    <li>The licence holder is allowed to enter and remain in the reservoir area on the understanding that he/she does so entirely at his/her own risk. He/She must take the land with everything thereon as he/she finds it and shall not have or make any claim for damage to or loss of property, personal injury or death against the Water Authority howsoever such damage to or loss of property, personal injury or death may be occasioned.</li>
                    <li>The licence is for the use of one rod and line only, and is not transferable.</li>
                    <li>The licence must be produced on demand by a police officer or other authorized officer.</li>
                    <li>Licences will not be issued to any person under the age of 13.</li>
                    <li>The use of nets or other appliances (apart from rod and line) or the use of explosive or toxic substances to catch or destroy fish is strictly prohibited.</li>
                    <li>The use of boats, dinghies, rafts etc. for fishing is prohibited.</li>
                    <li>Except the exempted fish, all Black Bass under 360 mm, all Snakehead under 300 mm and all other fish species under 180 mm in length measured from the most forward point of the head to the farthest tip of the tail shall be immediately returned alive to the water.</li>
                    <li>Except the exempted fish, not more than two Black Bass 360 mm or over and two Snakehead 300 mm or over and two numbers of each species 180 mm or over in length for any other fish species shall be retained by any one angler in one day.</li>
                    <li>The licence may later be revoked and replaced by another on different terms.</li>
                    <li>Please keep the licence intact. No copy will be issued on any loss or damage.</li>
                </ul>
            </section>

            <section data-lang="en" class="bg-white dark:bg-gray-800 rounded-xl p-5 shadow-sm border border-gray-100 dark:border-gray-700 mb-4 pb-20">
                <h3 class="text-lg font-bold mb-3">Apart from the above, anglers are also reminded that:</h3>
                <ul class="list-disc pl-5 space-y-3 text-sm leading-relaxed text-gray-700 dark:text-gray-200">
                    <li>To protect fish, birds and people from lead poisoning, anglers are prohibited to use lead fishing sinkers.</li>
                    <li>The release of any animals, including fish and reptiles, into reservoirs without the prior permission of the Water Authority is prohibited.</li>
                    <li>Do not litter or pollute the reservoirs.</li>
                </ul>
            </section>
            <section data-lang="zh" class="bg-white dark:bg-gray-800 rounded-xl p-5 shadow-sm border border-gray-100 dark:border-gray-700 mb-4 pb-20">
                <p class="text-sm leading-relaxed text-gray-700 dark:text-gray-200">
                    ä»¥ä¸Šå…§å®¹ç´”å±¬åƒè€ƒï¼Œä¸¦å¯èƒ½å› ç‚ºæ›´æ–°éœ€æ™‚ä¸¦æœªæ›´æ–°ï¼Œè«‹åƒé–±
                    <a class="text-primary underline" target="_blank" rel="noopener noreferrer" href="https://www.wsd.gov.hk/tc/customer-services/other-customer-services/fishing-in-reservoirs/application-for-fishing-licence/index.html">æ°´å‹™ç½²ç¶²ç«™</a>
                    é–±è®€æœ€æ–°å®˜æ–¹è¦å‰‡ã€‚
                </p>
            </section>
            <section data-lang="en" class="bg-white dark:bg-gray-800 rounded-xl p-5 shadow-sm border border-gray-100 dark:border-gray-700 mb-4 pb-20">
                <p class="text-sm leading-relaxed text-gray-700 dark:text-gray-200">
                    The above content is for reference only and may not reflect the latest updates. Please refer to the
                    <a class="text-primary underline" target="_blank" rel="noopener noreferrer" href="https://www.wsd.gov.hk/en/customer-services/other-customer-services/fishing-in-reservoirs/application-for-fishing-licence/index.html">WSD website</a>
                    for the latest official rules.
                </p>
            </section>
        </div>

        <div id="view-set" class="view-section h-full w-full absolute inset-0 bg-gray-50 dark:bg-gray-900 overflow-y-auto p-4 hidden z-[10]">
            <h2 class="text-2xl font-bold mb-6" data-i18n="tab_set">è¨­å®š</h2>

            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden divide-y divide-gray-100 dark:divide-gray-700">
                <div class="p-4 flex justify-between items-center">
                    <span data-i18n="settings_lang">èªè¨€</span>
                    <div class="flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1">
                        <button onclick="setLang('zh')" id="btn-zh" class="px-3 py-1 rounded text-sm font-bold transition">ä¸­æ–‡</button>
                        <button onclick="setLang('en')" id="btn-en" class="px-3 py-1 rounded text-sm font-bold transition">EN</button>
                    </div>
                </div>
                <div class="p-4 flex justify-between items-center">
                    <span data-i18n="settings_dark">æ·±è‰²æ¨¡å¼</span>
                    <button id="btn-dark" onclick="toggleDark()" class="w-12 h-6 bg-gray-300 rounded-full relative transition duration-300">
                        <div class="w-4 h-4 bg-white rounded-full absolute top-1 left-1 transition duration-300 shadow-sm"></div>
                    </button>
                </div>
                <button onclick="resetApp()" class="w-full p-4 text-left text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 transition">
                    <span data-i18n="settings_reset">é‡è¨­æ‰€æœ‰è¨­å®š</span>
                </button>
            </div>

            <div class="mt-4 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden divide-y divide-gray-100 dark:divide-gray-700">
                <button onclick="openSubpage('privacy')" class="w-full p-4 text-left hover:bg-gray-50 dark:hover:bg-gray-700/60 transition">
                    <span data-lang="zh">ç§éš±æ¢æ¬¾</span>
                    <span data-lang="en" class="hidden">Privacy Policy</span>
                </button>
                <button onclick="openSubpage('about')" class="w-full p-4 text-left hover:bg-gray-50 dark:hover:bg-gray-700/60 transition">
                    <span data-lang="zh">é—œæ–¼é–‹ç™¼è€…</span>
                    <span data-lang="en" class="hidden">About Developer</span>
                </button>
            </div>
        </div>

        <div id="view-privacy" class="view-section h-full w-full absolute inset-0 bg-gray-50 dark:bg-gray-900 overflow-y-auto p-4 hidden z-[20]">
            <button onclick="switchTab('set')" class="mb-4 inline-flex items-center gap-2 text-sm px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-800">
                <span aria-hidden="true">â†</span>
                <span data-lang="zh">è¿”å›</span>
                <span data-lang="en" class="hidden">Back</span>
            </button>
            <h2 class="text-2xl font-bold mb-4">
                <span data-lang="zh">ç§éš±æ”¿ç­–</span>
                <span data-lang="en" class="hidden">Privacy Policy</span>
            </h2>

            <div data-lang="zh" class="bg-white dark:bg-gray-800 rounded-xl p-5 shadow-sm border border-gray-100 dark:border-gray-700 space-y-3 text-sm leading-relaxed text-gray-700 dark:text-gray-200">
                <p><strong>ç”Ÿæ•ˆæ—¥æœŸï¼š</strong>2026-02-18</p>
                <p>é‡£é­šæ˜“ FishingEasy Hong Kongï¼ˆä¸‹ç¨±ã€Œæœ¬æ‡‰ç”¨ç¨‹å¼ã€ï¼‰å°Šé‡ä¸¦ä¿è­·æ‰€æœ‰ä½¿ç”¨è€…çš„å€‹äººç§éš±æ¬Šã€‚ç‚ºäº†çµ¦æ‚¨æä¾›æ›´æº–ç¢ºã€æ›´æœ‰å€‹æ€§åŒ–çš„æœå‹™ï¼Œæœ¬æ‡‰ç”¨ç¨‹å¼æœƒæŒ‰ç…§æœ¬ç§éš±æ¬Šæ”¿ç­–çš„è¦å®šä½¿ç”¨å’ŒæŠ«éœ²æ‚¨çš„å€‹äººä¿¡æ¯ã€‚</p>
                <p><strong>1. è³‡æ–™æ”¶é›†èˆ‡ä½¿ç”¨ï¼ˆData Collection &amp; Useï¼‰</strong></p>
                <p>æœ¬æ‡‰ç”¨ç¨‹å¼æ¡ç”¨ã€Œæœ¬åœ°å„ªå…ˆï¼ˆLocal-Firstï¼‰ã€æ¶æ§‹ã€‚é€™æ„å‘³è‘—æˆ‘å€‘ä¸æœƒå°‡æ‚¨çš„å€‹äººè³‡æ–™ä¸Šå‚³è‡³ä»»ä½•ç§äººä¼ºæœå™¨ã€‚</p>
                <p><strong>1.1 ä½ç½®è³‡è¨Šï¼ˆLocation Dataï¼‰</strong></p>
                <p>ç”¨é€”ï¼šæœ¬æ‡‰ç”¨ç¨‹å¼ä½¿ç”¨æ‚¨çš„åœ°ç†ä½ç½®ï¼ˆGPSï¼‰åƒ…ç”¨æ–¼åœ¨è£ç½®ç«¯å¯¦æ™‚è¨ˆç®—æ‚¨èˆ‡æœ€è¿‘æ°´å¡˜çš„è·é›¢ã€‚</p>
                <p>å„²å­˜ï¼šæ‚¨çš„ä½ç½®è³‡è¨Šä¸æœƒè¢«è¨˜éŒ„ã€è¿½è¹¤æˆ–ä¸Šå‚³è‡³æˆ‘å€‘çš„ä¼ºæœå™¨ã€‚</p>
                <p><strong>1.2 æ¼ç²æ—¥èªŒèˆ‡ç…§ç‰‡ï¼ˆCatch Logs &amp; Photosï¼‰</strong></p>
                <p>ç”¨é€”ï¼šæ‚¨åœ¨ã€Œæ—¥èªŒã€åŠŸèƒ½ä¸­æ‹æ”çš„ç…§ç‰‡åŠè¼¸å…¥çš„æ–‡å­—ï¼ˆå¦‚é­šç¨®ã€é•·åº¦ï¼‰ã€‚</p>
                <p>å„²å­˜ï¼šæ‰€æœ‰è³‡æ–™å‡å„²å­˜æ–¼æ‚¨æ‰‹æ©Ÿçš„å…§éƒ¨å„²å­˜ç©ºé–“ï¼ˆLocal Storageï¼‰ã€‚è‹¥æ‚¨åˆªé™¤æœ¬æ‡‰ç”¨ç¨‹å¼æˆ–æ¸…é™¤ç€è¦½å™¨ç·©å­˜ï¼Œé€™äº›è³‡æ–™å°‡æœƒæ¶ˆå¤±ã€‚</p>
                <p><strong>2. ç¬¬ä¸‰æ–¹æœå‹™èˆ‡æ•¸æ“šåˆ†äº«ï¼ˆThird-Party Servicesï¼‰</strong></p>
                <p>æœ¬æ‡‰ç”¨ç¨‹å¼ä½¿ç”¨ä»¥ä¸‹ç¬¬ä¸‰æ–¹æœå‹™ï¼Œå®ƒå€‘å¯èƒ½æœƒæ”¶é›†æ‚¨çš„è£ç½®è­˜åˆ¥ç¢¼ï¼ˆDevice IDï¼‰æˆ–ä½¿ç”¨ Cookie ä»¥æä¾›æœå‹™ã€‚</p>
                <p><strong>2.1 Google AdMobï¼ˆå»£å‘Šæœå‹™ï¼‰</strong></p>
                <p>æˆ‘å€‘ä½¿ç”¨ Google AdMob ä¾†é¡¯ç¤ºå»£å‘Šã€‚Google å¯èƒ½æœƒæ”¶é›†æ‚¨çš„è£ç½®è³‡è¨Šï¼ˆå¦‚å»£å‘Š IDï¼‰åŠç²—ç•¥ä½ç½®ï¼Œä»¥æä¾›å€‹æ€§åŒ–å»£å‘Šã€‚æ‚¨å¯ä»¥é€éè£ç½®çš„è¨­å®šä¾†é™åˆ¶å»£å‘Šè¿½è¹¤ã€‚</p>
                <p><strong>2.2 OpenStreetMap &amp; Leafletï¼ˆåœ°åœ–æœå‹™ï¼‰</strong></p>
                <p>åœ°åœ–åœ–å¡Šï¼ˆMap Tilesï¼‰ç”± OpenStreetMap æˆ–ç›¸é—œä¾›æ‡‰å•†æä¾›ã€‚åŠ è¼‰åœ°åœ–æ™‚ï¼Œæ‚¨çš„ IP ä½å€å¯èƒ½æœƒè¢«é€™äº›æœå‹™ä¾›æ‡‰å•†è¨˜éŒ„ã€‚</p>
                <p><strong>3. è³‡æ–™å®‰å…¨èˆ‡åˆªé™¤ï¼ˆData Security &amp; Deletionï¼‰</strong></p>
                <p><strong>3.1 è³‡æ–™å®‰å…¨</strong></p>
                <p>ç”±æ–¼è³‡æ–™å„²å­˜æ–¼æ‚¨çš„è£ç½®ä¸Šï¼Œæ‚¨çš„è³‡æ–™å®‰å…¨æ€§å–æ±ºæ–¼æ‚¨æ‰‹æ©Ÿçš„ä¿å®‰è¨­å®šï¼ˆå¦‚å¯†ç¢¼é–ã€ç”Ÿç‰©èªè­‰ï¼‰ã€‚</p>
                <p><strong>3.2 è³‡æ–™åˆªé™¤</strong></p>
                <p>æ‚¨å¯ä»¥éš¨æ™‚åœ¨æ‡‰ç”¨ç¨‹å¼çš„ã€Œè¨­å®šã€é é¢ä¸­é»æ“Šã€Œé‡ç½®æ‰€æœ‰è¨­å®šï¼ˆReset Allï¼‰ã€ï¼Œé€™å°‡ç«‹å³æ°¸ä¹…åˆªé™¤æœ¬æ‡‰ç”¨ç¨‹å¼å…§å„²å­˜çš„æ‰€æœ‰æ—¥èªŒèˆ‡è¨­å®šã€‚</p>
                <p><strong>4. å…è²¬è²æ˜ï¼ˆDisclaimerï¼‰</strong></p>
                <p><strong>4.1 åœ°åœ–æº–ç¢ºæ€§</strong></p>
                <p>æœ¬æ‡‰ç”¨ç¨‹å¼æä¾›çš„åœ°åœ–åƒ…ä¾›åƒè€ƒã€‚å¯¦éš›å‚é‡£ç¯„åœåŠæ³•è¦ï¼Œè«‹å‹™å¿…ä»¥ç¾å ´å‘Šç¤ºç‰ŒåŠå®˜æ–¹æœ€æ–°å…¬ä½ˆç‚ºæº–ã€‚</p>
                <p><strong>4.2 ä½¿ç”¨é¢¨éšª</strong></p>
                <p>ä½¿ç”¨è€…é ˆè‡ªè¡Œæ‰¿æ“”é€²å…¥æˆ¶å¤–åŠæ°´å¡˜ç¯„åœä¹‹é¢¨éšªã€‚é–‹ç™¼è€…ä¸å°ä»»ä½•é•è¦æª¢æ§ã€äººèº«æ„å¤–æˆ–è²¡ç‰©æå¤±è² è²¬ã€‚</p>
                <p><strong>5. æ”¿ç­–è®Šæ›´ï¼ˆChanges to This Policyï¼‰</strong></p>
                <p>æˆ‘å€‘å¯èƒ½æœƒä¸æ™‚æ›´æ–°æˆ‘å€‘çš„ç§éš±æ”¿ç­–ã€‚å»ºè­°æ‚¨å®šæœŸæŸ¥çœ‹æœ¬é é¢ä»¥ç²å–ä»»ä½•æ›´æ”¹ã€‚</p>
                <p><strong>6. è¯çµ¡æˆ‘å€‘ï¼ˆContact Usï¼‰</strong></p>
                <p>å¦‚æœæ‚¨å°æœ¬ç§éš±æ”¿ç­–æœ‰ä»»ä½•ç–‘å•ï¼Œè«‹é€éä»¥ä¸‹æ–¹å¼è¯çµ¡æˆ‘å€‘ï¼š</p>
                <p>Email: studioground2026@gmail.com</p>
            </div>

            <div data-lang="en" class="hidden bg-white dark:bg-gray-800 rounded-xl p-5 shadow-sm border border-gray-100 dark:border-gray-700 space-y-3 text-sm leading-relaxed text-gray-700 dark:text-gray-200">
                <p><strong>Effective Date:</strong> 2026-02-18</p>
                <p>FishingEasy Hong Kong (hereinafter referred to as "this App") respects and protects the privacy of all users. In order to provide you with more accurate and personalized services, this App will use and disclose your personal information in accordance with this Privacy Policy.</p>
                <p><strong>1. Data Collection &amp; Use</strong></p>
                <p>This App adopts a "Local-First" architecture. This means we DO NOT upload your personal data to any private servers.</p>
                <p><strong>1.1 Location Data</strong></p>
                <p>Purpose: We use your geolocation (GPS) solely to calculate your distance to reservoirs in real-time on your device.</p>
                <p>Storage: Your location data is NOT recorded, tracked, or uploaded to our servers.</p>
                <p><strong>1.2 Catch Logs &amp; Photos</strong></p>
                <p>Purpose: Photos taken and text entered (e.g., species, length) in the "Log" feature.</p>
                <p>Storage: All data is stored locally on your device's internal storage. If you uninstall the App or clear the cache, this data will be lost.</p>
                <p><strong>2. Third-Party Services</strong></p>
                <p>This App uses the following third-party services, which may collect your Device ID or use Cookies to provide services.</p>
                <p><strong>2.1 Google AdMob</strong></p>
                <p>We use Google AdMob to display ads. Google may collect your device information (such as Advertising ID) and coarse location to provide personalized ads. You can limit ad tracking through your device settings.</p>
                <p><strong>2.2 OpenStreetMap &amp; Leaflet</strong></p>
                <p>Map tiles are provided by OpenStreetMap or related providers. When loading maps, your IP address may be logged by these service providers.</p>
                <p><strong>3. Data Security &amp; Deletion</strong></p>
                <p><strong>3.1 Data Security</strong></p>
                <p>Since data is stored on your device, the security of your data depends on your phone's security settings (e.g., passcode, biometrics).</p>
                <p><strong>3.2 Data Deletion</strong></p>
                <p>You can tap "Reset All" in the "Settings" page at any time to immediately and permanently delete all logs and settings stored within this App.</p>
                <p><strong>4. Disclaimer</strong></p>
                <p><strong>4.1 Map Accuracy</strong></p>
                <p>The map provided are for reference only. Please strictly follow the on-site signs and official announcements.</p>
                <p><strong>4.2 Risks of Use</strong></p>
                <p>Users assume all risks associated with entering outdoor and reservoir areas. The developer is not responsible for any prosecutions, personal accidents, or property losses.</p>
                <p><strong>5. Changes to This Policy</strong></p>
                <p>We may update our Privacy Policy from time to time. You are advised to review this page periodically for any changes.</p>
                <p><strong>6. Contact Us</strong></p>
                <p>If you have any questions about this Privacy Policy, please contact us at:</p>
                <p>Email: studioground2026@gmail.com</p>
            </div>
        </div>

        <div id="view-about" class="view-section h-full w-full absolute inset-0 bg-gray-50 dark:bg-gray-900 overflow-y-auto p-4 hidden z-[20]">
            <button onclick="switchTab('set')" class="mb-4 inline-flex items-center gap-2 text-sm px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-800">
                <span aria-hidden="true">â†</span>
                <span data-lang="zh">è¿”å›</span>
                <span data-lang="en" class="hidden">Back</span>
            </button>
            <h2 class="text-2xl font-bold mb-4">
                <span data-lang="zh">é—œæ–¼é–‹ç™¼è€…</span>
                <span data-lang="en" class="hidden">About Developer</span>
            </h2>
            <div class="bg-white dark:bg-gray-800 rounded-xl p-5 shadow-sm border border-gray-100 dark:border-gray-700 space-y-2 text-sm text-gray-700 dark:text-gray-200">
                <p data-lang="zh">ï¼ˆå…§å®¹é ç•™ï¼Œå¯æ–¼æ­¤é åŠ å…¥é–‹ç™¼è€…ä»‹ç´¹ã€‚ï¼‰</p>
                <p data-lang="en" class="hidden">(Content reserved. You can add developer information on this page.)</p>
            </div>
        </div>
    </main>

    <nav id="bottom-nav" class="bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-800 flex justify-around items-center z-[100] shadow-[0_-5px_10px_rgba(0,0,0,0.02)]">
        <button onclick="switchTab('map')" class="nav-btn active flex flex-col items-center gap-1 w-full text-gray-400 hover:text-primary transition" id="nav-map">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path><path d="M2 12h20"></path></svg>
            <span class="text-[10px] font-bold" data-i18n="tab_map">åœ°åœ–</span>
        </button>
        <button onclick="switchTab('dex')" class="nav-btn flex flex-col items-center gap-1 w-full text-gray-400 hover:text-primary transition" id="nav-dex">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 1-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
            <span class="text-[10px] font-bold" data-i18n="tab_dex">æ¼ç²é™åˆ¶</span>
        </button>
        <button onclick="switchTab('log')" class="nav-btn flex flex-col items-center gap-1 w-full text-gray-400 hover:text-primary transition" id="nav-log">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>
            <span class="text-[10px] font-bold">
                <span data-lang="zh">æ•é­šæ—¥èªŒ</span>
                <span data-lang="en" class="hidden">Fishing Log</span>
            </span>
        </button>
        <button onclick="switchTab('rules')" class="nav-btn flex flex-col items-center gap-1 w-full text-gray-400 hover:text-primary transition" id="nav-rules">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 11l3 3L22 4"></path><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path></svg>
            <span class="text-[10px] font-bold">
                <span data-lang="zh">ç‰Œç…§è¦å‰‡</span>
                <span data-lang="en" class="hidden">License & Rules</span>
            </span>
        </button>
        <button onclick="switchTab('set')" class="nav-btn flex flex-col items-center gap-1 w-full text-gray-400 hover:text-primary transition" id="nav-set">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
            <span class="text-[10px] font-bold" data-i18n="tab_set">è¨­å®š</span>
        </button>
    </nav>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script>
        function setAdMobBannerHeight(heightPx) {
            const h = Math.max(0, Number(heightPx) || 50);
            document.documentElement.style.setProperty("--admob-banner-height", `${h}px`);
        }
    </script>
    <script src="./app.js"></script>
</body>
</html>

